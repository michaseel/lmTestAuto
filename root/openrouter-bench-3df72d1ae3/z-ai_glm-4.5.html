<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban Board</title>
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Canvas Confetti for celebration effect -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* Custom styles for smooth transitions */
        .card {
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .column {
            transition: background-color 0.3s ease;
        }
        
        .column.drag-over {
            background-color: rgba(99, 102, 241, 0.1);
            border-color: rgb(99, 102, 241);
        }
        
        .dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-content {
            animation: slideIn 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <h1 class="text-3xl font-bold flex items-center">
                <i class="fas fa-tasks mr-3"></i>
                Kanban Board
            </h1>
            <p class="text-indigo-200 mt-2">Organize your work efficiently</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Backlog Column -->
            <section class="column bg-white rounded-lg shadow-md p-4 border-2 border-gray-200" data-column="backlog">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">
                        <i class="fas fa-list-ul mr-2 text-blue-500"></i>
                        Backlog
                    </h2>
                    <button class="add-card-btn bg-blue-500 hover:bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center transition-colors">
                        <i class="fas fa-plus text-sm"></i>
                    </button>
                </div>
                <div class="card-container space-y-3 min-h-[100px]" data-column="backlog"></div>
            </section>

            <!-- In Progress Column -->
            <section class="column bg-white rounded-lg shadow-md p-4 border-2 border-gray-200" data-column="in-progress">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">
                        <i class="fas fa-spinner mr-2 text-yellow-500"></i>
                        In Progress
                    </h2>
                    <button class="add-card-btn bg-yellow-500 hover:bg-yellow-600 text-white rounded-full w-8 h-8 flex items-center justify-center transition-colors">
                        <i class="fas fa-plus text-sm"></i>
                    </button>
                </div>
                <div class="card-container space-y-3 min-h-[100px]" data-column="in-progress"></div>
            </section>

            <!-- Review Column -->
            <section class="column bg-white rounded-lg shadow-md p-4 border-2 border-gray-200" data-column="review">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">
                        <i class="fas fa-search mr-2 text-purple-500"></i>
                        Review
                    </h2>
                    <button class="add-card-btn bg-purple-500 hover:bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center transition-colors">
                        <i class="fas fa-plus text-sm"></i>
                    </button>
                </div>
                <div class="card-container space-y-3 min-h-[100px]" data-column="review"></div>
            </section>

            <!-- Done Column -->
            <section class="column bg-white rounded-lg shadow-md p-4 border-2 border-gray-200" data-column="done">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">
                        <i class="fas fa-check-circle mr-2 text-green-500"></i>
                        Done
                    </h2>
                    <button class="add-card-btn bg-green-500 hover:bg-green-600 text-white rounded-full w-8 h-8 flex items-center justify-center transition-colors">
                        <i class="fas fa-plus text-sm"></i>
                    </button>
                </div>
                <div class="card-container space-y-3 min-h-[100px]" data-column="done"></div>
            </section>
        </div>
    </main>

    <!-- Modal for Add/Edit Card -->
    <div id="cardModal" class="modal">
        <div class="modal-content bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4">
            <h3 class="text-2xl font-bold mb-4 text-gray-800">
                <span id="modalTitle">Add New Card</span>
            </h3>
            <form id="cardForm">
                <div class="mb-4">
                    <label for="cardTitle" class="block text-gray-700 font-medium mb-2">Title</label>
                    <input type="text" id="cardTitle" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
                </div>
                <div class="mb-6">
                    <label for="cardDescription" class="block text-gray-700 font-medium mb-2">Description</label>
                    <textarea id="cardDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancelBtn" class="px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors">
                        Save
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4">
            <div class="text-center">
                <i class="fas fa-exclamation-triangle text-5xl text-yellow-500 mb-4"></i>
                <h3 class="text-2xl font-bold mb-2 text-gray-800">Confirm Delete</h3>
                <p class="text-gray-600 mb-6">Are you sure you want to delete this card? This action cannot be undone.</p>
                <div class="flex justify-center space-x-3">
                    <button id="cancelDeleteBtn" class="px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg transition-colors">
                        Cancel
                    </button>
                    <button id="confirmDeleteBtn" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Namespace for localStorage to avoid conflicts
        const KANBAN_NAMESPACE = 'kanban_app_v1';
        
        // DOM Elements
        const cardModal = document.getElementById('cardModal');
        const confirmModal = document.getElementById('confirmModal');
        const cardForm = document.getElementById('cardForm');
        const modalTitle = document.getElementById('modalTitle');
        const cardTitleInput = document.getElementById('cardTitle');
        const cardDescriptionInput = document.getElementById('cardDescription');
        const cancelBtn = document.getElementById('cancelBtn');
        const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
        const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
        
        // State management
        let cards = [];
        let currentCardId = null;
        let cardToDelete = null;
        
        // Initialize the Kanban board
        function init() {
            loadCardsFromStorage();
            renderCards();
            setupEventListeners();
        }
        
        // Load cards from localStorage
        function loadCardsFromStorage() {
            const storedCards = localStorage.getItem(KANBAN_NAMESPACE);
            if (storedCards) {
                cards = JSON.parse(storedCards);
            } else {
                // Create dummy cards if none exist
                createDummyCards();
            }
        }
        
        // Create dummy cards for demonstration
        function createDummyCards() {
            const dummyCards = [
                { id: generateId(), title: 'Design Homepage', description: 'Create wireframes and mockups for the homepage', column: 'backlog' },
                { id: generateId(), title: 'Setup Database', description: 'Configure the database schema and connections', column: 'in-progress' },
                { id: generateId(), title: 'User Authentication', description: 'Implement login and registration functionality', column: 'review' },
                { id: generateId(), title: 'Create README', description: 'Write comprehensive documentation for the project', column: 'done' }
            ];
            cards = dummyCards;
            saveCardsToStorage();
        }
        
        // Save cards to localStorage
        function saveCardsToStorage() {
            localStorage.setItem(KANBAN_NAMESPACE, JSON.stringify(cards));
        }
        
        // Generate unique ID for cards
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }
        
        // Render all cards in their respective columns
        function renderCards() {
            // Clear all card containers
            document.querySelectorAll('.card-container').forEach(container => {
                container.innerHTML = '';
            });
            
            // Render each card
            cards.forEach(card => {
                const cardElement = createCardElement(card);
                const container = document.querySelector(`.card-container[data-column="${card.column}"]`);
                container.appendChild(cardElement);
            });
        }
        
        // Create a card element
        function createCardElement(card) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'card bg-gray-50 rounded-lg p-4 shadow cursor-grab border border-gray-200';
            cardDiv.draggable = true;
            cardDiv.dataset.cardId = card.id;
            
            cardDiv.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <h3 class="font-semibold text-gray-800 flex-grow pr-2">${card.title}</h3>
                    <button class="delete-card text-gray-400 hover:text-red-500 transition-colors">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
                <p class="text-gray-600 text-sm">${card.description || 'No description'}</p>
            `;
            
            // Add event listeners
            cardDiv.addEventListener('dragstart', handleDragStart);
            cardDiv.addEventListener('dragend', handleDragEnd);
            cardDiv.addEventListener('click', handleCardClick);
            cardDiv.querySelector('.delete-card').addEventListener('click', handleDeleteClick);
            
            return cardDiv;
        }
        
        // Setup all event listeners
        function setupEventListeners() {
            // Add card buttons
            document.querySelectorAll('.add-card-btn').forEach(btn => {
                btn.addEventListener('click', handleAddCardClick);
            });
            
            // Modal events
            cardForm.addEventListener('submit', handleCardSubmit);
            cancelBtn.addEventListener('click', closeModal);
            cancelDeleteBtn.addEventListener('click', closeConfirmModal);
            confirmDeleteBtn.addEventListener('click', handleConfirmDelete);
            
            // Close modals when clicking outside
            cardModal.addEventListener('click', (e) => {
                if (e.target === cardModal) closeModal();
            });
            
            confirmModal.addEventListener('click', (e) => {
                if (e.target === confirmModal) closeConfirmModal();
            });
            
            // Drag and drop for columns
            document.querySelectorAll('.column').forEach(column => {
                column.addEventListener('dragover', handleDragOver);
                column.addEventListener('drop', handleDrop);
                column.addEventListener('dragleave', handleDragLeave);
            });
        }
        
        // Handle add card button click
        function handleAddCardClick(e) {
            const column = e.currentTarget.closest('.column').dataset.column;
            currentCardId = null;
            modalTitle.textContent = 'Add New Card';
            cardTitleInput.value = '';
            cardDescriptionInput.value = '';
            cardForm.dataset.column = column;
            openModal();
        }
        
        // Handle card click (edit)
        function handleCardClick(e) {
            if (e.target.closest('.delete-card')) return;
            
            const cardId = e.currentTarget.dataset.cardId;
            const card = cards.find(c => c.id === cardId);
            
            if (card) {
                currentCardId = cardId;
                modalTitle.textContent = 'Edit Card';
                cardTitleInput.value = card.title;
                cardDescriptionInput.value = card.description || '';
                cardForm.dataset.column = card.column;
                openModal();
            }
        }
        
        // Handle delete card click
        function handleDeleteClick(e) {
            e.stopPropagation();
            const cardId = e.currentTarget.closest('.card').dataset.cardId;
            cardToDelete = cardId;
            openConfirmModal();
        }
        
        // Handle card form submission
        function handleCardSubmit(e) {
            e.preventDefault();
            
            const title = cardTitleInput.value.trim();
            const description = cardDescriptionInput.value.trim();
            const column = cardForm.dataset.column;
            
            if (title) {
                if (currentCardId) {
                    // Update existing card
                    const cardIndex = cards.findIndex(c => c.id === currentCardId);
                    if (cardIndex !== -1) {
                        cards[cardIndex] = {
                            ...cards[cardIndex],
                            title,
                            description,
                            column
                        };
                    }
                } else {
                    // Add new card
                    const newCard = {
                        id: generateId(),
                        title,
                        description,
                        column
                    };
                    cards.push(newCard);
                }
                
                saveCardsToStorage();
                renderCards();
                closeModal();
            }
        }
        
        // Handle confirm delete
        function handleConfirmDelete() {
            if (cardToDelete) {
                cards = cards.filter(c => c.id !== cardToDelete);
                saveCardsToStorage();
                renderCards();
                closeConfirmModal();
            }
        }
        
        // Drag and Drop Handlers
        let draggedElement = null;
        
        function handleDragStart(e) {
            draggedElement = e.currentTarget;
            e.currentTarget.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.currentTarget.innerHTML);
        }
        
        function handleDragEnd(e) {
            e.currentTarget.classList.remove('dragging');
        }
        
        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            
            const column = e.currentTarget.closest('.column');
            if (column) {
                column.classList.add('drag-over');
            }
            
            return false;
        }
        
        function handleDragLeave(e) {
            const column = e.currentTarget.closest('.column');
            if (column && !column.contains(e.relatedTarget)) {
                column.classList.remove('drag-over');
            }
        }
        
        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            
            const column = e.currentTarget.closest('.column');
            if (column && draggedElement) {
                column.classList.remove('drag-over');
                
                const cardId = draggedElement.dataset.cardId;
                const newColumn = column.dataset.column;
                const oldColumn = draggedElement.closest('.column').dataset.column;
                
                // Update card column in state
                const cardIndex = cards.findIndex(c => c.id === cardId);
                if (cardIndex !== -1) {
                    cards[cardIndex].column = newColumn;
                    saveCardsToStorage();
                    
                    // Trigger confetti if moved to Done
                    if (newColumn === 'done' && oldColumn !== 'done') {
                        triggerConfetti();
                    }
                }
                
                // Move card element
                const cardContainer = column.querySelector('.card-container');
                cardContainer.appendChild(draggedElement);
            }
            
            return false;
        }
        
        // Modal functions
        function openModal() {
            cardModal.classList.add('active');
            cardTitleInput.focus();
        }
        
        function closeModal() {
            cardModal.classList.remove('active');
            currentCardId = null;
        }
        
        function openConfirmModal() {
            confirmModal.classList.add('active');
        }
        
        function closeConfirmModal() {
            confirmModal.classList.remove('active');
            cardToDelete = null;
        }
        
        // Trigger confetti animation
        function triggerConfetti() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
        }
        
        // Initialize the application
        init();
    </script>
</body>
</html>